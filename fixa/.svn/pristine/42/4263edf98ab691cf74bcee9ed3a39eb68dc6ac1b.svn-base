<?php

class SolicitacaoIntragov {
	   public $id_usuario_intragov;      
     public $devolucao;                  
     public $id_canal_entrada;               
     public $id_produto_intragov;            
     public $servico_intragov;               
     public $qtd_acessos;                    
     public $motivo_cancelamento;            
     public $cnpj;                           
     public $razao_social;                   
     public $n_gestao_servicos;              
     public $data_abertura_gestao;          
     public $motivo_devolucao;               
     public $area_solicitante;               
     public $data_devolucao;                
     public $data_encerramento;              
     public $status;                         
     public $reg_dt_entrada;                
     public $revisao;                        
     public $complemento_servico;
     public $data_recebimento;
     public $descricao_motivo_devolucao;
     public $obs;


     function constroiSolicitacaoIntragov(SolicitacaoIntragov $solicitacao, $devolucao, $canal_entrada, $produtoIntragov, $servicoIntragov, $qtd_acessos, $cnpj, $razao_social, $data_abertura_gestao, $data_encerramento, $status_solicitacao_intragov, $reg_dt_entrada, $complemento_servico, $obs)
     {
          $solicitacao->devolucao            = $devolucao;                  
          $solicitacao->id_canal_entrada     = $canal_entrada;               
          $solicitacao->id_produto_intragov  = $produtoIntragov;            
          $solicitacao->servico_intragov     = $servicoIntragov;               
          $solicitacao->qtd_acessos          = $qtd_acessos;                    
          $solicitacao->cnpj                 = $cnpj;                           
          $solicitacao->razao_social         = $razao_social;                   
          $solicitacao->data_abertura_gestao = $data_abertura_gestao;          
          $solicitacao->data_encerramento    = $data_encerramento;              
          $solicitacao->status               = $status_solicitacao_intragov;                         
          $solicitacao->reg_dt_entrada       = $reg_dt_entrada;                
          $solicitacao->complemento_servico  = $complemento_servico;
          $solicitacao->obs                  = $obs;

          return $solicitacao;
     }

      //busca data que o operador habilitou a solicitacao
     function buscaDataRecebimentoSolicitacao($idgs, $id_usuario, $revisao)
     {
          $busca_data_receb_solicitacao = mysql_query("SELECT 
                                                            date_format(reg_data,'%d/%m/%Y %H:%i:%s') AS reg_data 
                                                       FROM usuario_solicitacao 
                                                       WHERE id_solicitacao = $idgs AND id_usuario = $id_usuario AND revisao = $revisao
                                                  ");

          if(mysql_affected_rows() > 0)
          {
                 while($linhaSolicitacao=mysql_fetch_array($busca_data_receb_solicitacao))
                 { 
                     $data_receb_solicitacao  = $linhaSolicitacao['reg_data'];
                 }

                 return $data_receb_solicitacao;
          } 
     }

     function validaCamposObrigatorios(SolicitacaoIntragov $solicitacao)
     {
          //valida campos obrigatÃ³rios
          if(
               empty($solicitacao->id_canal_entrada)         ||
               empty($solicitacao->id_produto_intragov)      ||
               empty($solicitacao->servico_intragov)         ||
               ($solicitacao->qtd_acessos == "")             ||    
               empty($solicitacao->cnpj)                     ||
               ($solicitacao->razao_social  == "")           ||
               empty($solicitacao->data_abertura_gestao)     ||
               empty($solicitacao->data_encerramento)        ||
               empty($solicitacao->status)
          )
          {
               return true;
          }     
     }

     function validaItensDevolucao($motivo_devolucao, $descricao_motivo_devolucao, $area_devolucao, $data_devolucao)
     {
          //se for devolucao nenhum dos campos pode estar em branco(se 1 estiver mostrara erro ao usuario)
         if(
                empty($motivo_devolucao)                                 || 
                empty($descricao_motivo_devolucao)                       || 
                empty($area_devolucao)                                   || 
                empty($data_devolucao)                                   ||
                ($motivo_devolucao == "Selecione o motivo")              ||
                ($descricao_motivo_devolucao == "Selecione a descricao") 
          )
         {
               return true;
         }
     }
    
}