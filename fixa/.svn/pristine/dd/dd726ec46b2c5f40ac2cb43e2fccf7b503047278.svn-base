<?php
include("../fixa/bd.php");
require_once '../fixa/site/classes/cripto.php';
require_once '../fixa/site/classes/SolicitacaoIntragov.php';
require_once '../fixa/site/classes/Produto.php';
?>

<?php
$cripto = new cripto();
//parametros
$id_usuario = $_GET['id']; 
$id_usuario = $cripto->decodificar($id_usuario);
$id_gs = $_GET['idgs'];
$revisao = $_GET['rev']; 

?>
<?php
//pega projeto do operador logado
$sqlProjetoUsuario = mysql_query("SELECT projeto FROM usuario WHERE id_usuario = $id_usuario");

while($rowP=mysql_fetch_array($sqlProjetoUsuario))
{
	$projeto = $rowP['projeto'];
}

//cria objeto
$SolicitacaoIntragovOperador = new SolicitacaoIntragov();
$SolicitacaoIntragovOperador->data_recebimento = $SolicitacaoIntragovOperador->buscaDataRecebimentoSolicitacao($id_gs,$id_usuario,$revisao); 
?>
<div id="div_form_intragov" class="bradius wrapper">
	<form 
		action="principal.php?&rev=<?php echo $revisao?>&idgs=<?php echo $id_gs?>&id=<?php echo $cripto->codificar($id_usuario) ?>&t=controles/sql_form_intragov.php" 
		method="POST"	
	>
		<fieldset id="fieldset_style">
			<h2>Intragov</h2> 
			<table id="form_intragov">
				<tr>
					<td>
						<div class="div_forms">
							<label>Data da solicitação*</label>
							<input 
								type="text"
								id="data_solicitacao"
								name="data_solicitacao"
								class="campos_desabilitados" 
								onblur = "validaData(this)";
								required
								value= "<?php echo $SolicitacaoIntragovOperador->data_recebimento;?>"
								disabled="true"
							>
						</div>
					</td>
					<td>
						<div class="div_forms">
							<label>Canal de entrada*</label>
							<select 
								name="canal_entrada" 
								id="canal_entrada" 
								class="txt2comboboxpadrao bradius"
								required
								>

								<?php 
						         
						         	$canal_entrada=mysql_query("SELECT * FROM canal_entrada WHERE id_canal_entrada IN (9,4,3,10,18)");

						         while($rowce=mysql_fetch_array($canal_entrada)){
					                     
					        	?>
					        	<option value="<?php echo $rowce['id_canal_entrada']; ?>">
						   			<?php echo $rowce['descricao']; ?>
						   		</option>
						   		<?php 
			          				}
			     				?>
						  	</select>
						</div>
					</td>
				</tr>
				<tr>
					<td>
						<div class="div_forms">
							<label>Produto Intragov*</label>
							<select 
								name="produtoIntragov" 
								id="produtoIntragov" 
								class="txt2comboboxpadrao bradius"
								required
							>
							<option></option>
							<?php 
						         
						         $produto=mysql_query("SELECT * FROM produto WHERE categoria_produto LIKE '%$projeto%'");

						         while($rowp=mysql_fetch_array($produto)){
					                     
					        	?>
					        	<option value="<?php echo $rowp['id_produto']; ?>">
						   			<?php echo $rowp['descricao']; ?>
						   		</option>
						   		<?php 
			          				}
			     				?>
						  	</select>
						</div>
					</td>
					<td>
						<div class="div_forms">
							<label>Serviço Intragov*</label>
							<select 
								name="servicoIntragov" 
								id="servicoIntragov" 
								class="txt2comboboxpadrao bradius"
								required
								>
					  		</select>
						</div>
					</td>
				</tr>
				<tr>
					<td>
						<div class="div_forms">
							<label>Complemento Serviço*</label>
							<select 
								name="complementoServicoIntragov" 
								id="complementoServicoIntragov" 
								class="txt2comboboxpadrao bradius"
								required>
						  	</select>
						</div>
					</td>
					<td>
						<div class="div_forms">
							<label>Quantidade de acessos*</label>
							<input 
								type="text" 
								id="qtd_acessos"  
								name="qtd_acessos"
								pattern="\d+"
								size= "50"
								required
							/>
						</div>
					</td>	
				</tr>
				<tr>
					<td>
						<div class="div_forms">
							<label>Motivo Cancelamento</label>
							<i class="fa fa-exclamation" title="Quando escolher o item Cancelamento no campo 'Serviço' preencher este campo"></i>
							<input 
								type="text" 
								id="motivo_cancelamento"  
								name="motivo_cancelamento"
								size= "50"
								disabled="true" 
							/>
						</div>
					</td>
					<td>
						<div class="div_forms">
							<label>CNPJ*</label>
							<input 
								type="text" 
								id="cnpj"  
								name="cnpj"
								size= "50"
								required
							/>
						</div>
					</td>
				</tr>
				<tr>
					<td>
						<div class="div_forms">
							<label>Razão Social*</label>
							<input 
								type="text" 
								id="razao_social"  
								name="razao_social"
								size= "50"
								required
							/>
						</div>
					</td>
					<td>
						<div class="div_forms">
							<label>Número gestão de serviços*</label>
							<input 
								type="text" 
								id="n_gs"  
								name="n_gs"
								placeholder="Caso não haja, favor preencher como 0"
								pattern="\d+"
								size= "50"
								required
								value= "<?php echo $idgs;?>"
								disabled="true"
								class="campos_desabilitados"
							/>
						</div>
					</td>	
				</tr>
				<tr>
					<td>
						<div class="div_forms">
							<label>Data abertura gestão*</label>
							<input 
								type="text"
								id="data_abert_gestao"
								name="data_abert_gestao" 
								class="campoData"
								onblur = "validaData(this)";
								size= "50"
								required
							>
						</div>
					</td>
					<td>
						<div class="div_forms">
							<label>Status*</label>
							<select 
								name="status_solicitacao_intragov" 
								id="status_solicitacao_intragov" 
								class="txt2comboboxpadrao bradius"
								required
								>
								<?php 
						         	
									
						         	$statuss=mysql_query("SELECT * FROM status_solicitacao WHERE id_status_solicitacao = 15
															UNION SELECT * FROM status_solicitacao WHERE id_status_solicitacao IN(1,2,3,4,5,8)");
						         	

									while($rowss=mysql_fetch_array($statuss)){
					                     
					        	?>
					        	<option value="<?php echo $rowss['id_status_solicitacao']; ?>">
						   			<?php echo $rowss['descricao']; ?>
						   		</option>
						   		<?php 
			          				}
			     				?>
		     				</select>
						</div>
					</td>
				</tr>
				<tr>
					<td>
						<div class="div_forms">
							<label>Data de encerramento*</label>
							<input 
								type="text"
								id="data_encerramento"
								name="data_encerramento" 
								class="campoData" 
								onblur = "validaData(this)";
								size= "50"
								required 
							>
						</div>
					</td>
					<td>
						<div class="div_forms">
							<label>Observações</label>
							<input 
								type="text" 
								id="obs"  
								class="txt bradius" 
								name="obs"
							/> 
						</div>
					</td>
				</tr>
				<tr>	
					<td>
						<div class="div_forms">
							<label>Devolução</label><br/>
							<label class="radio-inline">
							  	<input 
							  		style="width: 24px;" 
							  		type="radio" 
							  		name="devolucao" 
							  		id="devolucao_n" 
							  		value="Não"
							  		checked="true" 
						  		> Não
							</label>
							<label class="radio-inline">
							  	<input 
							  		style="width: 24px;" 
							  		type="radio" 
							  		name="devolucao" 
							  		id="devolucao_s" 
							  		value="Sim"
						  		> Sim
							</label>
						</div>
					</td>
					<td id="rcd1" class="campos_devolucao">
						<div class="div_forms">
							<label>Área Solicitante*</label>
							<select 
								type="text" 
								id="area_devolucao"  
								class="txt2comboboxpadrao bradius" 
								name="area_devolucao"
								required
							>
								<option value="POSICIONAMENTO">POSICIONAMENTO</option>
								<option value="COMERCIAL">COMERCIAL</option>
								<option value="MKT">MKT</option>
								<option value="SISTEMAS">SISTEMAS</option>
								<option value="AG. TELEFONICA">AG. TELEFÔNICA</option>
							</select> 
						</div>
					</td>			
				</tr>
				<tr id="rcd2" class="campos_devolucao">
					<td>
						<div class="div_forms">
							<label>Motivo devolução</label>
							<select 
								name="motivo_devolucao" 
								id="motivo_devolucao" 
								class="txt2comboboxpadrao bradius"
								disabled="true" 
								>
					  		</select>
						</div>
					</td>
					<td>
						<div class="div_forms">
							<label>Descrição motivo devolução</label>
							<select 
								name="descricao_motivo_devolucao" 
								id="descricao_motivo_devolucao" 
								class="txt2comboboxpadrao bradius"
								disabled="true">
					  		</select>
						</div>
					</td>		
				</tr>
				<tr id="rcd3" class="campos_devolucao">
					<td>
						<div class="div_forms">
							<label>Data de devolução</label>
							<input 
								type="text"
								id="data_devolucao"
								name="data_devolucao" 
								disabled="true"
								class="campoData" 
								onblur = "validaData(this)";
								size= "50"
							>
						</div>
					</td>
				</tr>
			</table>
			<br/>
			<input name="bt_enviar_form" id="bt_enviar_form" type="submit" value="Salvar" class="sb2 bradius" />
	 		<input name="cancelar" type="button" value="Cancelar" class="sb2 bradius" id="cancelar"/>
	 	</fieldset>
	</form>
</div>

  
    